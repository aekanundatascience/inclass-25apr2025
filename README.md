# SCADA Data Analysis Tool

เครื่องมือวิเคราะห์ข้อมูลจากตาราง SCADA_Data ในฐานข้อมูล Electric

## ฟีเจอร์ของโค้ด

1. **เชื่อมต่อกับฐานข้อมูล MSSQL**: ใช้ข้อมูลการเชื่อมต่อที่กำหนดไว้เพื่อเชื่อมต่อกับฐานข้อมูล Electric
2. **ดึงข้อมูล SCADA_Data**: ดึงข้อมูลทั้งหมดจากตาราง SCADA_Data
3. **วิเคราะห์ข้อมูลรายวัน**: วิเคราะห์และสรุปข้อมูลตามวันที่
4. **วิเคราะห์ข้อมูลตาม DUID**: วิเคราะห์และสรุปข้อมูลตามอุปกรณ์ (DUID)
5. **วิเคราะห์ข้อมูลตามชั่วโมง**: วิเคราะห์และสรุปข้อมูลตามชั่วโมงของวัน
6. **สร้างกราฟและแผนภูมิ**: สร้างกราฟและแผนภูมิแสดงผลการวิเคราะห์
7. **บันทึกผลลัพธ์**: บันทึกผลลัพธ์เป็นไฟล์ CSV และ PDF

## การติดตั้ง

### การติดตั้งด้วย conda

```bash
# สร้าง conda environment ใหม่
conda env create -f environment.yml

# เปิดใช้งาน environment
conda activate scada_env
```

### การติดตั้งด้วย pip

```bash
# ติดตั้ง dependencies
pip install -r requirements.txt
```

## วิธีการใช้งาน

1. ตรวจสอบข้อมูลการเชื่อมต่อฐานข้อมูลใน `scada_analysis.py`:

```python
DB_SERVER = '34.134.173.24'
DB_NAME = 'Electric'
DB_USER = 'SA'
DB_PASSWORD = 'Passw0rd123456'
```

2. รันสคริปต์:

```bash
python scada_analysis.py
```

3. ผลลัพธ์จะถูกบันทึกในโฟลเดอร์ `scada_analysis_results` โดยมีไฟล์ดังนี้:
   - ไฟล์ CSV แสดงข้อมูลสรุปรายวัน
   - ไฟล์ CSV แสดงข้อมูลสรุปตาม DUID
   - ไฟล์ CSV แสดงข้อมูลสรุปตามชั่วโมง
   - ไฟล์ PDF รวมกราฟและแผนภูมิทั้งหมด

## ผลลัพธ์ที่ได้

1. **กราฟแสดงจำนวนข้อมูลรายวัน**: แสดงจำนวนข้อมูลที่บันทึกในแต่ละวัน
2. **กราฟแสดงค่าเฉลี่ย SCADAVALUE รายวัน**: แสดงค่าเฉลี่ยของ SCADAVALUE ในแต่ละวัน
3. **กราฟแสดงค่า SCADAVALUE สูงสุดและต่ำสุดรายวัน**: แสดงค่าสูงสุดและต่ำสุดของ SCADAVALUE ในแต่ละวัน
4. **กราฟแสดง Top 10 DUID ที่มีค่าเฉลี่ย SCADAVALUE สูงสุด**: แสดง 10 อันดับ DUID ที่มีค่าเฉลี่ย SCADAVALUE สูงสุด
5. **กราฟแสดงค่าเฉลี่ย SCADAVALUE ตามชั่วโมง**: แสดงค่าเฉลี่ยของ SCADAVALUE ในแต่ละชั่วโมงของวัน
6. **กราฟแสดงจำนวนข้อมูลตามชั่วโมง**: แสดงจำนวนข้อมูลที่บันทึกในแต่ละชั่วโมงของวัน

## ความต้องการของระบบ

- Python 3.6 หรือสูงกว่า
- pymssql
- pandas
- numpy
- matplotlib
- seaborn